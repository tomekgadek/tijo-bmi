<!DOCTYPE html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org">

<head th:replace="base.html :: head"></head>

<body th:replace="base.html :: layout(~{::content})">
    <div th:fragment="content">
        <div class="page-header">
            <a href="/admin/dashboard" class="back-link">&larr; Powrót do panelu</a>
            <h1 th:text="'Szczegóły: ' + ${user.username}">Szczegóły</h1>
        </div>

        <div class="pure-g">
            <div class="pure-u-1 pure-u-md-1-2 user-detail-grid">
                <div class="card">
                    <h3>Dane użytkownika</h3>
                    <p><strong>Imię i nazwisko:</strong> <span
                            th:text="${user.firstName != null ? user.firstName + ' ' + user.lastName : '-'}"></span></p>
                    <p><strong>Wzrost:</strong> <span
                            th:text="${user.height != null ? user.height + ' cm' : '-'}"></span></p>
                    <p><strong>Status:</strong> <span th:text="${user.isPublic ? 'Publiczny' : 'Prywatny'}"></span></p>
                    <p><strong>Utworzono:</strong> <span
                            th:text="${user.createdAt != null ? #temporals.format(user.createdAt, 'dd.MM.yyyy HH:mm') : '-'}"></span>
                    </p>
                </div>
            </div>
            <div class="pure-u-1 pure-u-md-1-2 user-detail-grid">
                <div class="card">
                    <h3>Osiągnięcia i Cele</h3>
                    <p
                        th:text="${user.achievement != null and user.achievement != '' ? user.achievement : 'Brak danych.'}">
                    </p>
                    <div th:if="${user.motivationalQuote != null and user.motivationalQuote != ''}"
                        class="user-quote">
                        <span th:text="'&quot;' + user.motivationalQuote + '&quot;'"></span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Historia wag</h3>
            <table class="pure-table pure-table-horizontal history-table">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Waga</th>
                        <th>BMI</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="record : ${weightHistory}">
                        <td
                            th:text="${record.recordDate != null ? #temporals.format(record.recordDate, 'dd.MM.yyyy') : '-'}">
                        </td>
                        <td th:text="${record.weight} + ' kg'"></td>
                        <td
                            th:text="${record.calculateBMI() != null ? #numbers.formatDecimal(record.calculateBMI(), 1, 1) : '-'}">
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="card danger-zone">
            <h3 class="danger-zone-title">Strefa niebezpieczna</h3>
            <p class="danger-zone-subtitle">Zarządzaj dostępem użytkownika.</p>

            <div class="danger-zone-actions">
                <a th:if="${!user.isBlocked}" th:href="@{/admin/user/block/{id}(id=${user.id})}" class="pure-button block-btn">Blokuj użytkownika</a>
                <a th:if="${user.isBlocked}" th:href="@{/admin/user/unblock/{id}(id=${user.id})}" class="pure-button unblock-btn">Odblokuj użytkownika</a>

                <form th:action="@{/admin/user/delete/{id}(id=${user.id})}" method="post"
                    onsubmit="return confirm('Czy na pewno chcesz usunąć tego użytkownika?')">
                    <button type="submit" class="pure-button delete-btn">Usuń użytkownika</button>
                </form>
            </div>
        </div>
    </div>
</body>

</html>
